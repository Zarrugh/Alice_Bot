#resp0={'text': 'turn on kitchen light and turn off bedroom light', 'intents': [{'id': '414973499427813', 'name': 'trun_off', 'confidence': 0.9867}], 'entities': {'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 16, 'end': 21, 'body': 'light', 'confidence': 1, 'entities': [], 'value': 'light', 'type': 'value'}, {'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 43, 'end': 48, 'body': 'light', 'confidence': 0.9691, 'entities': [], 'value': 'light', 'type': 'value'}], 'room:room': [{'id': '579020069332269', 'name': 'room', 'role': 'room', 'start': 8, 'end': 15, 'body': 'kitchen', 'confidence': 1, 'entities': [], 'value': 'kitchen', 'type': 'value'}, {'id': '579020069332269', 'name': 'room', 'role': 'room', 'start': 35, 'end': 42, 'body': 'bedroom', 'confidence': 0.7977, 'entities': [], 'suggested': True, 'value': 'bedroom', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'could you help me turning on kitchen light', 'intents': [{'id': '2696380533953622', 'name': 'turn_on', 'confidence': 0.9178}], 'entities': {'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 37, 'end': 42, 'body': 'light', 'confidence': 0.9368, 'entities': [], 'value': 'light', 'type': 'value'}], 'room:room': [{'id': '579020069332269', 'name': 'room', 'role': 'room', 'start': 29, 'end': 36, 'body': 'kitchen', 'confidence': 0.8452, 'entities': [], 'value': 'kitchen', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'could you help me', 'intents': [], 'entities': {}, 'traits': {}}
#resp0={'text': "what's the weather looks like to be today in Tripoli Libya", 'intents': [{'id': '590163498218122', 'name': 'ask_weather', 'confidence': 0.9999}], 'entities': {'wit$location:location': [{'id': '3028075573906404', 'name': 'wit$location', 'role': 'location', 'start': 45, 'end': 58, 'body': 'Tripoli Libya', 'confidence': 0.9168, 'entities': [], 'suggested': True, 'value': 'Tripoli Libya', 'type': 'value'}], 'wit$datetime:datetime': [{'id': '619016245395390', 'name': 'wit$datetime', 'role': 'datetime', 'start': 36, 'end': 41, 'body': 'today', 'confidence': 0.9512, 'entities': [], 'type': 'value', 'grain': 'day', 'value': '2020-12-25T00:00:00.000-08:00', 'values': [{'type': 'value', 'grain': 'day', 'value': '2020-12-25T00:00:00.000-08:00'}]}]}, 'traits': {}}
#resp0={'text': 'turn on the kitchen light and turn off the bedroom light', 'intents': [{'id': '2696380533953622', 'name': 'turn_on', 'confidence': 0.9731}], 'entities': {'wit$location:location': [{'id': '3028075573906404', 'name': 'wit$location', 'role': 'location', 'start': 43, 'end': 50, 'body': 'bedroom', 'confidence': 0.8968, 'entities': [], 'suggested': True, 'value': 'bedroom', 'type': 'value'}], 'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 20, 'end': 25, 'body': 'light', 'confidence': 0.9757, 'entities': [], 'value': 'light', 'type': 'value'}, {'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 51, 'end': 56, 'body': 'light', 'confidence': 0.8407, 'entities': [], 'value': 'light', 'type': 'value'}], 'room:room': [{'id': '579020069332269', 'name': 'room', 'role': 'room', 'start': 12, 'end': 19, 'body': 'kitchen', 'confidence': 0.9756, 'entities': [], 'value': 'kitchen', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'could you help me', 'intents': [{'id': '1134107693671926', 'name': 'asking_for_help', 'confidence': 0.9894}], 'entities': {}, 'traits': {}}
resp0={'text': 'open Spotify then turn the kitchen light on', 'intents': [{'id': '294129901831166', 'name': 'open_app', 'confidence': 0.9929}], 'entities': {'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 35, 'end': 40, 'body': 'light', 'confidence': 1, 'entities': [], 'value': 'light', 'type': 'value'}], 'room:room': [{'id': '579020069332269', 'name': 'room', 'role': 'room', 'start': 27, 'end': 34, 'body': 'kitchen', 'confidence': 1, 'entities': [], 'value': 'kitchen', 'type': 'value'}], 'appTopen:appTopen': [{'id': '828071334392484', 'name': 'appTopen', 'role': 'appTopen', 'start': 5, 'end': 12, 'body': 'Spotify', 'confidence': 0.884, 'entities': [], 'value': 'spotify', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'who is Bill Gates and turn on the bedroom light', 'intents': [{'id': '2696380533953622', 'name': 'turn_on', 'confidence': 0.9005}], 'entities': {'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 42, 'end': 47, 'body': 'light', 'confidence': 0.9272, 'entities': [], 'value': 'light', 'type': 'value'}], 'wit$location:location': [{'id': '3028075573906404', 'name': 'wit$location', 'role': 'location', 'start': 34, 'end': 41, 'body': 'bedroom', 'confidence': 0.9034, 'entities': [], 'suggested': True, 'value': 'bedroom', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'can you run Spotify and close music app', 'intents': [{'id': '294129901831166', 'name': 'open_app', 'confidence': 0.8841}], 'entities': {'appTopen:appTopen': [{'id': '828071334392484', 'name': 'appTopen', 'role': 'appTopen', 'start': 12, 'end': 19, 'body': 'Spotify', 'confidence': 1, 'entities': [], 'value': 'spotify', 'type': 'value'}]}, 'traits': {}}
#resp0={'text': 'tell me about Leonardo da Vinci turn off the light off', 'intents': [{'id': '414973499427813', 'name': 'trun_off', 'confidence': 0.9914}], 'entities': {'turn_object:turn_object': [{'id': '930368084130537', 'name': 'turn_object', 'role': 'turn_object', 'start': 45, 'end': 50, 'body': 'light', 'confidence': 1, 'entities': [], 'value': 'light', 'type': 'value'}], 'wit$location:location': [{'id': '3028075573906404', 'name': 'wit$location', 'role': 'location', 'start': 14, 'end': 31, 'body': 'Leonardo da Vinci', 'confidence': 0.8759, 'entities': [], 'suggested': True, 'value': 'Leonardo da Vinci', 'type': 'value'}]}, 'traits': {}}
def filter_resp(resp0):
    FilteredDic={}
    if resp0['intents']!={}:
        BestRespCount=0
        conf=0
        count=0
        for intents in resp0['intents']:
            if intents['confidence']>conf:
                conf=intents['confidence']
                BestRespCount=count
                count+=1
                #if resp0['intents']['confidence']>0.9:
                #FilteredDic['intents']=[resp0['intents'][BestRespCount]['name'],resp0['intents'][BestRespCount]['confidence']]
        FilteredDic['intents']=[resp0['intents'][BestRespCount]['name']]
        #print(FilteredDic)
        ListOfEntities={}
        if resp0['entities']!={}:
            bassconf=False
            #print(resp0['entities'].values())
            for entities in resp0['entities']:
                #print(entities)
                for entitie in resp0['entities'][entities]:
                    #print(entitie)
                    if entitie['confidence']>0.75:
                        bassconf = True
                        if not (entitie['name'] in ListOfEntities and entitie['value'] in ListOfEntities):
                            ListOfEntities[entitie['name']]=entitie['value']
            if bassconf:
                FilteredDic['entities']=ListOfEntities
        if resp0['text']:
            FilteredDic['text']=[resp0['text']]
    return(FilteredDic)

#resp0={'text': 'how many type of a human being right now', 'intents': [], 'entities': {'wit$datetime:datetime': [{'id': '619016245395390', 'name': 'wit$datetime', 'role': 'datetime', 'start': 31, 'end': 40, 'body': 'right now', 'confidence': 0.9611, 'entities': [], 'type': 'value', 'grain': 'second', 'value': '2021-01-08T02:48:33.000-08:00', 'values': [{'type': 'value', 'grain': 'second', 'value': '2021-01-08T02:48:33.000-08:00'}]}]}, 'traits': {}}

print(filter_resp(resp0))
